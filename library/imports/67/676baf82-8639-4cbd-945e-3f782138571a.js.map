{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Scripts\\Home/assets\\Scripts\\Home\\AnimationController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Scripts\\Home","sourcesContent":["import global from \"../Common/Global\";\r\nimport animationManager from \"../Common/AnimationMgr\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n/*var animation = [\"gameStart\", \"hasniu\", \"niuniu\", \"silvercow\", \"goldcow\", \"fivecows\", \"bomb\", \"allkill\",\r\n    \"victory\", \"kingicon\"];*/\r\n\r\n@ccclass\r\nexport default class AnimationController extends cc.Component {\r\n\r\n    private animation: any;\r\n    private animationName: string[] = [\"gameStart\", \"hasniu\", \"niuniu\", \"silvercow\", \"goldcow\", \"fivecows\", \"bomb\", \"allkill\",\r\n        \"victory\", \"kingicon\"];\r\n\r\n    private moneyPrefabs:cc.Node[][] = [];\r\n    private bgPref:cc.Node[] = [];\r\n    \r\n    @property(cc.Node)\r\n    testButton: cc.Node = null;\r\n\r\n    @property(cc.Prefab)\r\n    mPrefab: cc.Prefab = null;\r\n\r\n    @property(cc.Prefab)\r\n    bgPrefab: cc.Prefab = null;\r\n    \r\n    init() {\r\n        this.animation = {\r\n            gameStart: cc.find(\"gameStart\", this.node),\r\n            AllKill: cc.find(\"allkill\", this.node),\r\n            hasniu: null,\r\n            niuniu: cc.find(\"niuniu\", this.node),\r\n            silvercow: cc.find(\"silvercow\", this.node),\r\n            goldcow: cc.find(\"goldcow\", this.node),\r\n            fivecows: cc.find(\"fivecows\", this.node),\r\n            bomb: cc.find(\"bomb\", this.node),\r\n            Victory: cc.find(\"victory\", this.node),\r\n        };\r\n\r\n        for (let index: number = 0; index < 5; index++) {\r\n            this.moneyPrefabs[index] = [];\r\n            for(let i: number = 0;i<20;i++){\r\n                //generate 20 coin for each position \r\n                let genGold: cc.Node = cc.instantiate(this.mPrefab);\r\n                genGold.parent = this.node;\r\n                this.moneyPrefabs[index].push(genGold);\r\n            }\r\n            let shineBg: cc.Node = cc.instantiate(this.bgPrefab);\r\n            shineBg.parent = this.node;\r\n            this.bgPref.push(shineBg);\r\n        }\r\n    }\r\n\r\n    onLoad() {\r\n        this.init();\r\n\r\n        let self = this;\r\n\r\n        global.Instance.EventListener.on(\"moneyFlow\", function (event,Info) {\r\n            cc.log(\"get money pack\");\r\n            let king = Info.king;\r\n            for (let index: number = 0; index < 5; index++) {\r\n                if (index == king) index++;\r\n                if( Info.give[index] > 0 ) self.trigger(king,index,index);\r\n                else cc.log(\"give 0$ to\"+index+\", no anime\");\r\n                cc.log(\"from me to\" + index);\r\n                cc.log(\"king = \" + king + \"  index = \" + index);\r\n            }\r\n\r\n            /*\r\n\r\n            self.schedule(function() {\r\n                for (let index = 0; index < 5; index++) {\r\n                    if (index == king) index++;\r\n                    if( Info.get[index] > 0 ) self.trigger(index,king,index);\r\n                    else cc.log(\"get 0$ from\"+index+\", no anime\");\r\n                    cc.log(\"from\" + index+\"to me\");\r\n                }\r\n            }, 1);//delay 3s\r\n            */\r\n            \r\n        });\r\n\r\n        global.Instance.EventListener.on(\"playTestMoneyFlow\", function (event) {\r\n            cc.log(\"test money\");\r\n            self.trigger(0,1,1);\r\n\r\n            /*\r\n            let king = Info.king;\r\n            for (let index = 0; index < 5; index++) {\r\n                if (index == king) index++;\r\n                if( Info.give[index] > 0 ) self.trigger(king,index,index);\r\n                else cc.log(\"give 0$ to\"+index+\", no anime\");\r\n                cc.log(\"from me to\" + index);\r\n                cc.log(\"king = \" + king + \"  index = \" + index);\r\n            }\r\n\r\n\r\n            self.schedule(function() {\r\n                for (let index = 0; index < 5; index++) {\r\n                    if (index == king) index++;\r\n                    if( Info.get[index] > 0 ) self.trigger(index,king,index);\r\n                    else cc.log(\"get 0$ from\"+index+\", no anime\");\r\n                    cc.log(\"from\" + index+\"to me\");\r\n                }\r\n            }, 1);//delay 3s\r\n            */\r\n            \r\n        });\r\n\r\n        global.Instance.EventListener.on(\"Animation\", function (event, animationName) {\r\n            cc.log(\"AnimationController : \", animationName);\r\n            let index = self.animationName.indexOf(animationName);\r\n            cc.log(\"trigger anime : \" + animationName);\r\n            self.play(index);\r\n        });\r\n\r\n    }\r\n\r\n    play(AnimationIndex: number) {\r\n        cc.log(\"playing animation at aniCtrler\");\r\n        if (AnimationIndex < 0) return;\r\n        this.node.getChildren()[AnimationIndex].active = true;\r\n        this.node.getChildren()[AnimationIndex].getComponent(cc.Animation).play();\r\n    }\r\n\r\n    showAllTestButton() {\r\n        let self = this;\r\n        self.testButton.active = !self.testButton.active;\r\n    }\r\n\r\n    testButtonPress(event, customEventData:number) {\r\n        let self = this;\r\n        if (customEventData == 10) global.Instance.EventListener.notify(\"playTestMoneyFlow\");\r\n        else self.play(customEventData);\r\n    }\r\n\r\n    trigger(from:number,to:number,pos:number){\r\n        cc.log(\"trigger money\");\r\n        //money\r\n        let self = this;\r\n        for(let i = 0;i<20;i++) {\r\n            let a = Math.floor(Math.random() * (19 - 0 + 1)) + 1;//亂數產生1~20\r\n            cc.log(\"pass\" + from + \",\" + to);\r\n            self.moneyPrefabs[pos][i].getComponent(\"moneyAnime\").moneyFlow(from,to,10*i-100,10*i-100, i+a );\r\n        }\r\n        //money shine\r\n        self.bgPref[pos].getComponent(\"moneyBgAnime\").moneyShine(to);\r\n    }\r\n\r\n}\r\n"]}