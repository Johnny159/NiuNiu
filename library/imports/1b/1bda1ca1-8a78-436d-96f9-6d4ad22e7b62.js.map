{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Scripts\\Common/assets\\Scripts\\Common\\AudioMgr.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Scripts\\Common","sourcesContent":["import Global from \"./Global\";\r\n\r\nconst {ccclass, property, executionOrder} = cc._decorator;\r\n\r\n@ccclass\r\n@executionOrder(-1) //Make sure register to Instance in the first\r\nexport default class AudioMgr extends cc.Component {\r\n   \r\n    @property\r\n    isMusic: boolean = true;\r\n\r\n    @property\r\n    isEffect: boolean = true;\r\n\r\n    private curBGM: string = '';\r\n\r\n    private loadingList:[string, cc.AudioClip][] = [];\r\n   \r\n\r\n    onLoad () \r\n    {\r\n        Global.Instance.audio = this;\r\n        cc.game.on(cc.game.EVENT_HIDE, function () {\r\n            cc.log(\"cc.audioEngine.pauseAll\");\r\n            cc.audioEngine.pauseAll();\r\n        });\r\n\r\n        cc.game.on(cc.game.EVENT_SHOW, function () {\r\n            cc.log(\"cc.audioEngine.resumeAll\");\r\n            cc.audioEngine.resumeAll();\r\n        });\r\n\r\n    }\r\n\r\n    playMusic(_clip:string, _isloop: boolean = true) \r\n    {\r\n        if(!this.isMusic)\r\n            return\r\n\r\n        let url = \"Audio/Music/\" + _clip;\r\n        if (this.curBGM === url)\r\n            return;\r\n      \r\n        let isLoad = this.loadingList.find( x => x[0] === url);\r\n\r\n        if(isLoad) {\r\n            cc.audioEngine.playMusic(isLoad[1], _isloop);\r\n        }\r\n        else {\r\n            let self = this;\r\n            cc.loader.loadRes(url, cc.AudioClip, function (err, clip) {\r\n                if(err) {\r\n                    cc.error(err);              \r\n                    return \r\n                }\r\n\r\n                if(self.curBGM !== '') {\r\n                    cc.audioEngine.stopMusic();\r\n                }\r\n    \r\n                cc.audioEngine.playMusic(clip, _isloop);\r\n                self.curBGM = url;\r\n                self.loadingList.push([url, clip]);\r\n            });       \r\n        }\r\n       \r\n    }\r\n\r\n    playEffect(_clip:string, _isloop: boolean = false, _callback: Function = null) \r\n    {\r\n        if(!this.isEffect)\r\n            return\r\n\r\n\r\n        let url = \"Audio/Effect/\";\r\n        let isLoad = this.loadingList.find( x => x[0] === url);\r\n        if(isLoad) {\r\n            cc.audioEngine.playEffect(isLoad[1], _isloop);\r\n        }\r\n        else {            \r\n            cc.loader.loadRes(url, cc.AudioClip, function (err, clip) {       \r\n                if(err) {\r\n                    cc.error(err);              \r\n                    return \r\n                }    \r\n                cc.audioEngine.playEffect(clip, _isloop);\r\n            });\r\n        }\r\n    }\r\n\r\n    releaseAll()\r\n    {\r\n        for(let i = 0; i < this.loadingList.length; i++ ) {\r\n            cc.loader.releaseAsset(this.loadingList[i][1]);            \r\n        }\r\n        this.loadingList = [];\r\n    }\r\n\r\n    pauseAll()\r\n    {\r\n        cc.audioEngine.pauseAll();\r\n    }\r\n    \r\n    resumeAll()\r\n    {\r\n        cc.audioEngine.resumeAll();\r\n    }\r\n\r\n    muteMusic(_mute: boolean = true) \r\n    {\r\n        this.isMusic = !_mute;\r\n\r\n        if(_mute) {\r\n            cc.audioEngine.setMusicVolume(0);\r\n        }\r\n        else {\r\n            cc.audioEngine.setMusicVolume(1);\r\n        }\r\n    }\r\n\r\n    muteEffect(_mute: boolean = true) \r\n    {\r\n        this.isEffect = !_mute;\r\n\r\n        if(_mute) {\r\n            cc.audioEngine.setEffectsVolume(0);\r\n        }\r\n        else {\r\n            cc.audioEngine.setEffectsVolume(1);\r\n        }\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}