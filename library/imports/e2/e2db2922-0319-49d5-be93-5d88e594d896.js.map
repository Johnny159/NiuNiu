{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\prefabs\\TalkMenuController/assets\\prefabs\\TalkMenuController\\TalkMenuController.js"],"names":["cc","Class","extends","Component","properties","TalkMenu","default","type","Node","TalkMenuOpenBtn","Button","TalkMenuCloseBtn","isOpened","content","Me","Next","Pre","NextNext","PrePre","nextCounter","PreCounter","nextNextCounter","PrePreCounter","onLoad","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","openMenu","closeMenu","active","Talk","event","customEventData","temp","getChildByName","currentTarget","_name","getComponent","Label","string","wid","i","length","width","label","node","x","scheduleOnce","closeLabel","keyCode","log"],"mappings":"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","file":"TalkMenuController.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\prefabs\\TalkMenuController","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        TalkMenu: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        TalkMenuOpenBtn: {\r\n            default: null,\r\n            type: cc.Button\r\n        },\r\n        TalkMenuCloseBtn: {\r\n            default: null,\r\n            type: cc.Button\r\n        },\r\n        isOpened: false,\r\n        content: cc.Node,\r\n        Me: cc.Node,\r\n        Next: cc.Node,\r\n        Pre: cc.Node,\r\n        NextNext: cc.Node,\r\n        PrePre: cc.Node,\r\n        nextCounter: -1,\r\n        PreCounter: -1,\r\n        nextNextCounter: -1,\r\n        PrePreCounter: -1,\r\n    },\r\n    onLoad() {\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n    },\r\n    openMenu() {\r\n        if (this.isOpened == true)\r\n            this.closeMenu();\r\n        else {\r\n            this.TalkMenu.active = true;\r\n            this.TalkMenuCloseBtn.active = true;\r\n            this.isOpened = true;\r\n        }\r\n    },\r\n    closeMenu() {\r\n        this.TalkMenu.active = false;\r\n        this.TalkMenuCloseBtn.active = false;\r\n        this.isOpened = false;\r\n    },\r\n    Talk(event, customEventData) {\r\n        this.Me.active = true;\r\n        var temp = this.content.getChildByName(event.currentTarget._name).getChildByName(\"Label\").getComponent(cc.Label).string\r\n\r\n        var wid = 0;\r\n        for (var i = 0; i < temp.length; i++) {\r\n            if (temp[i] >= 'A' && temp[i] <= 'Z')\r\n                wid += 15;\r\n            else if (temp[i] >= 'a' && temp[i] <= 'z')\r\n                wid += 13;\r\n            else {\r\n                wid += 23\r\n            }\r\n        }\r\n        this.Me.width = wid + 23 * 2\r\n        var label = this.Me.getChildByName(\"Label\").getComponent(cc.Label);\r\n        label.string = temp;\r\n        label.node.x = 23\r\n        this.TalkMenuOpenBtn.active = false;\r\n        this.closeMenu();\r\n        this.scheduleOnce(function () {\r\n            this.closeLabel(this.Me);\r\n        }, 1.5);\r\n    },\r\n    closeLabel(label) {\r\n        label.active = false;\r\n        this.TalkMenuOpenBtn.active = true;\r\n\r\n    },\r\n    onKeyDown: function (event) {\r\n        //cc.log(event.keyCode)\r\n        switch (event.keyCode) {\r\n            case 69: // E鑑，NextNext\r\n                this.NextNext.active = true;\r\n                this.nextNextCounter++;\r\n                if (this.nextNextCounter > 9)\r\n                    this.nextNextCounter = 0;\r\n                var temp = this.content.getChildByName(\"option\" + this.nextNextCounter).getChildByName(\"Label\").getComponent(cc.Label).string\r\n\r\n                var wid = 0;\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    if (temp[i] >= 'A' && temp[i] <= 'Z')\r\n                        wid += 15;\r\n                    else if (temp[i] >= 'a' && temp[i] <= 'z')\r\n                        wid += 13;\r\n                    else {\r\n                        wid += 23\r\n                    }\r\n                }\r\n                this.NextNext.width = wid + 23 * 2\r\n                var label = this.NextNext.getChildByName(\"Label\").getComponent(cc.Label);\r\n                label.string = temp;\r\n                label.node.x = 23\r\n                this.TalkMenuOpenBtn.active = false;\r\n                this.closeMenu();\r\n                this.scheduleOnce(function () {\r\n                    cc.log(\"NextNext active false\");\r\n                    this.closeLabel(this.NextNext);\r\n                    this.NextNext.active = false;\r\n                }, 1.5);\r\n                break;\r\n            case 68: // D鑑，Next\r\n                this.Next.active = true;\r\n                this.nextCounter++;\r\n                if (this.nextCounter > 9)\r\n                    this.nextCounter = 0;\r\n                var temp = this.content.getChildByName(\"option\" + this.nextCounter).getChildByName(\"Label\").getComponent(cc.Label).string\r\n\r\n                var wid = 0;\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    if (temp[i] >= 'A' && temp[i] <= 'Z')\r\n                        wid += 15;\r\n                    else if (temp[i] >= 'a' && temp[i] <= 'z')\r\n                        wid += 13;\r\n                    else {\r\n                        wid += 23\r\n                    }\r\n                }\r\n                this.Next.width = wid + 23 * 2\r\n                var label = this.Next.getChildByName(\"Label\").getComponent(cc.Label);\r\n                label.string = temp;\r\n                label.node.x = 23\r\n                this.TalkMenuOpenBtn.active = false;\r\n                this.closeMenu();\r\n                this.scheduleOnce(function () {\r\n                    this.closeLabel(this.Next);\r\n                    this.Next.active = false;\r\n                }, 1.5);\r\n                break;\r\n            case 65: // A鑑，Pre\r\n                this.Pre.active = true;\r\n                this.PreCounter++;\r\n                if (this.PreCounter > 9)\r\n                    this.PreCounter = 0;\r\n                var temp = this.content.getChildByName(\"option\" + this.PreCounter).getChildByName(\"Label\").getComponent(cc.Label).string\r\n\r\n                var wid = 0;\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    if (temp[i] >= 'A' && temp[i] <= 'Z')\r\n                        wid += 15;\r\n                    else if (temp[i] >= 'a' && temp[i] <= 'z')\r\n                        wid += 13;\r\n                    else {\r\n                        wid += 23\r\n                    }\r\n                }\r\n                this.Pre.width = wid + 23 * 2\r\n                var label = this.Pre.getChildByName(\"Label\").getComponent(cc.Label);\r\n                label.string = temp;\r\n                label.node.x = 23\r\n                this.TalkMenuOpenBtn.active = false;\r\n                this.closeMenu();\r\n                this.scheduleOnce(function () {\r\n                    this.closeLabel(this.Pre);\r\n                    this.Pre.active = false;\r\n                }, 1.5);\r\n                break;\r\n            case 81: // Q鑑，PrePre\r\n                this.PrePre.active = true;\r\n                this.PrePreCounter++;\r\n                if (this.PrePreCounter > 9)\r\n                    this.PrePreCounter = 0;\r\n                var temp = this.content.getChildByName(\"option\" + this.PrePreCounter).getChildByName(\"Label\").getComponent(cc.Label).string\r\n\r\n                var wid = 0;\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    if (temp[i] >= 'A' && temp[i] <= 'Z')\r\n                        wid += 15;\r\n                    else if (temp[i] >= 'a' && temp[i] <= 'z')\r\n                        wid += 13;\r\n                    else {\r\n                        wid += 23\r\n                    }\r\n                }\r\n                this.PrePre.width = wid + 23 * 2\r\n                var label = this.PrePre.getChildByName(\"Label\").getComponent(cc.Label);\r\n                label.string = temp;\r\n                label.node.x = 23\r\n                this.TalkMenuOpenBtn.active = false;\r\n                this.closeMenu();\r\n                this.scheduleOnce(function () {\r\n                    this.closeLabel(this.PrePre);\r\n                    this.PrePre.active = false;\r\n                }, 1.5);\r\n                break;\r\n        }\r\n    },\r\n\r\n\r\n});\r\n"]}